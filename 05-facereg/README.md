# opencv-tutorial
(1）第一步是图像或视频解码，光图像就有N多种格式：bmp，jpg，png，pgm，ppm等等，每种里面都可能还有细分，比如有损的图像，无损的图像，你都需要自己来写；
(2）人脸检测，最简单的就是harr特征，自己写，分类器是adaboost，自己写，人脸检测的训练流程，测试流程，人脸检测模型的读取和输出，都要自己写；
(3）人脸识别，最简单的，特征脸eigenface，其中涉及最简单的pca算法，矩阵特征分解算法，自己写，配上最简单的分类器最近邻，计算向量的距离，自己写，人脸识别训练流程，识别流程，自己写；
(4）其他的数据预处理，各种IO操作等等；



特征脸EigenFace从思想上其实挺简单。就相当于把人脸从像素空间变换到另一个空间，在另一个空间中做相似性的计算。这么说，其实图像识别的基本思想都是一样的，首先选择一个合适的子空间，将所有的图像变换到这个子空间上，然后再在这个子空间上衡量相似性或者进行分类学习。那为什么要变换到另一个空间呢？当然是为了更好的做识别或者分类了。那为什么变换到一个空间就好识别或者分类了呢？因为变换到另一个空间，同一个类别的图像会聚到一起，不同类别的图像会距离比较远，或者在原像素空间中不同类别的图像在分布上很难用个简单的线或者面把他们切分开，然后如果变换到另一个空间，就可以很好的把他们分开了。有时候，线性（分类器）就可以很容易的把他们分开了。那既然人类看起来同类的图像本来就是相似的，不同类的图像就不太相似，那为什么在原始的像素空间他们同类不会很近，不同类不会很远，或者他们为什么不好分开呢？因为图像各种因素的影响，包括光照、视角、背景和形状等等不同，会造成同一个目标的图像都存在很大的视觉信息上的不同。

重头戏来了，要变换到什么空间，才具备上述这种良好类内相似、类间区分的效果？到这，我就只能say sorry了。计算机视觉领域发展了几十年，就为了这一个问题倾注了无数研究者的智慧与心血。当然了，也诞生和孕育了很多经典和有效的解答。（个人理解，上述说的实际上就是特征提取）。从一开始的颜色特征（颜色直方图）、纹理特征（Harr、LBP、HOG、SIFT等）、形状特征等到视觉表达Bag of Words，再到特征学习Deep Learning，技术的发展总能带给人希望，曙光也越来越清晰，但路还很远，是不？      

       扯太多了，严重离题了。上面说到，特征脸EigenFace的思想是把人脸从像素空间变换到另一个空间，在另一个空间中做相似性的计算。EigenFace选择的空间变换方法是PCA，也就是大名鼎鼎的主成分分析。它广泛的被用于预处理中以消去样本特征维度之间的相关性。当然了，这里不是说这个。EigenFace方法利用PCA得到人脸分布的主要成分，具体实现是对训练集中所有人脸图像的协方差矩阵进行本征值分解，得对对应的本征向量，这些本征向量（特征向量）就是“特征脸”。每个特征向量或者特征脸相当于捕捉或者描述人脸之间的一种变化或者特性。这就意味着每个人脸都可以表示为这些特征脸的线性组合。实际上，空间变换就等同于“搞基”，原始像素空间的基就是单位“基”，经过PCA后空间就是以每一个特征脸或者特征向量为基，在这个空间（或者坐标轴）下，每个人脸就是一个点，这个点的坐标就是这个人脸在每个特征基下的投影坐标。哦噢，说得有点绕。

下面就直接给出基于特征脸的人脸识别实现过程：

1）将训练集的每一个人脸图像都拉长一列，将他们组合在一起形成一个大矩阵A。假设每个人脸图像是MxM大小，那么拉成一列后每个人脸样本的维度就是d=MxM大小了。假设有N个人脸图像，那么样本矩阵A的维度就是dxN了。

2）将所有的N个人脸在对应维度上加起来，然后求个平均，就得到了一个“平均脸”。你把这个脸显示出来的话，还挺帅的哦。

3）将N个图像都减去那个平均脸图像，得到差值图像的数据矩阵Φ。

4）计算协方差矩阵C=ΦΦT。再对其进行特征值分解。就可以得到想要的特征向量（特征脸）了。

5）将训练集图像和测试集的图像都投影到这些特征向量上了，再对测试集的每个图像找到训练集中的最近邻或者k近邻啥的，进行分类即可。


Reference:
1 http://blog.csdn.net/zouxy09/article/details/45276053
2 http://brightguo.com/face-recognition-with-opencv/
3 http://www.ipresst.com/w/1l9lcs/play
4 http://blog.csdn.net/chary8088/article/details/24935505
5 http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/core/interoperability_with_OpenCV_1/interoperability_with_OpenCV_1.html

Notice:
此人脸检测和识别的例子参考http://blog.csdn.net/chary8088/article/details/24935505， 但由于作者应该是基于opencv-1.0，我修改为
基于opencv-2.4.13的Mac下的代码。但此demo识别率很差，后面再考虑优化和将code分为service和client。
